<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: system | 脑波网]]></title>
  <link href="http://dexterdeng.github.com/blog/categories/system/atom.xml" rel="self"/>
  <link href="http://dexterdeng.github.com/"/>
  <updated>2013-01-07T13:21:14+08:00</updated>
  <id>http://dexterdeng.github.com/</id>
  <author>
    <name><![CDATA[Dexter Deng]]></name>
    <email><![CDATA[dexterdeng@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[一点经验教训]]></title>
    <link href="http://dexterdeng.github.com/blog/2013/01/07/%5B%3F%5D-dian-jing-yan-jiao-xun/"/>
    <updated>2013-01-07T12:27:00+08:00</updated>
    <id>http://dexterdeng.github.com/blog/2013/01/07/[?]-dian-jing-yan-jiao-xun</id>
    <content type="html"><![CDATA[<h3>流量刚过15k，一个新的里程碑</h3>

<p>坚持做两年的项目， 流量上了一个新阶段。</p>

<p>很多问题随之产生， 这里就最近的一些经验。稍微总结一下。</p>

<h3>数据库session表超大，导致dump文件超大，11G</h3>

<p>最近数据库dump文件超大，一直欣慰的以为数据量大了，实则可笑至极。</p>

<p>在解决这个问题过程中， 我找到几个方案。</p>

<h4>数据量真的庞大</h4>

<p>对数据做partition, 这样数据库更稳定。</p>

<h4>有很庞大的表</h4>

<p>如果数据不是很有价值，那么应该删除过期数据。
如果数据很有价值，那么应该分表了。</p>

<h3>Perconas是个好东西， 更省cpu</h3>

<p>以后有机会，要换这个数据库。</p>

<h3>数据库恢复时，手动restore 了一些表，</h3>

<p>发现一下行其实是有作用的，否则容易出现法语乱码:</p>

<blockquote><p>-- MySQL dump 10.11
  --
  -- Host: localhost    Database: blabla</p>

<hr />

<p>  -- Server version5.0.92-log</p>

<p>/<em>!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT </em>/;
  /<em>!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS </em>/;
  /<em>!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION </em>/;
  /<em>!40101 SET NAMES utf8 </em>/;
  /<em>!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE </em>/;
  /<em>!40103 SET TIME_ZONE='+00:00' </em>/;
  /<em>!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 </em>/;
  /<em>!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS,
  FOREIGN_KEY_CHECKS=0 </em>/;
  /<em>!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO'
  </em>/;
  /<em>!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 </em>/;</p></blockquote>
]]></content>
  </entry>
  
</feed>
